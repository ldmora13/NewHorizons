---
import MainLayout from "../layouts/MainLayout.astro";
const backgroundImage = "/img/passport-european-map.jpg";

export interface PaymentSectionProps {
  id?: string;
  title: string;
  description: string;
  amount: string;
  customer: string;
  service: string;
  transaction_id: string;
  date: string;
  payment_method: string;
  status: string;
  btnPrint: string;
  btnBack: string
}

const props = Astro.props as PaymentSectionProps;

const {
  id = "payment",
  title,
  description,
  amount,
  customer,
  service,
  transaction_id,
  date,
  payment_method,
  status,
  btnPrint,
  btnBack
} = props;
---

<MainLayout title="Payment Successful | New Horizons">
  <section class="min-h-screen py-24 flex items-center justify-center bg-slate-900/50">
    <div class="max-w-xl w-full mx-4">
      <!-- Ticket Container -->
      <div id="ticket" class="bg-white rounded-3xl overflow-hidden shadow-2xl">
        <!-- Ticket Header -->
        <div class="p-8 text-center text-white relative" 
          style={`background-image: url('${backgroundImage}');
              background-size: cover;
              background-position: center;
              background-repeat: no-repeat;
              image-rendering: -webkit-optimize-contrast;
              image-rendering: crisp-edges;
            `}>
            <div class="absolute inset-0 bg-black/50"></div>
          <div class="relative z-10">
            <div class="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm border border-white/30">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
              </svg>
            </div>
            <h1 class="text-3xl font-bold uppercase tracking-wider" data-i18n="payment.title">{title}</h1>
            <p class="text-blue-100 mt-2" data-i18n="payment.description">{description}</p>
          </div>
        </div>

        <!-- Ticket Body -->
        <div class="p-8 space-y-8 bg-[radial-gradient(#e5e7eb_1px,transparent_1px)] bg-size-[16px_16px]">
          
          <!-- Amount Section -->
          <div class="text-center pb-8 border-b border-dashed border-gray-300">
            <p class="text-gray-500 uppercase text-xs font-bold tracking-widest mb-1" data-i18n="payment.amount">{amount}</p>
            <h2 class="text-5xl font-black text-gray-900">$<span id="display-amount">0.00</span> <span class="text-lg font-medium text-gray-400">USD</span></h2>
          </div>

          <!-- Details Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1" data-i18n="payment.customer">{customer}</p>
              <p id="display-client" class="text-gray-800 font-medium">Guest</p>
            </div>
            <div>
              <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1" data-i18n="payment.service">{service}</p>
              <p id="display-service" class="text-gray-800 font-medium">Immigration Program</p>
            </div>
            <div>
              <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1" data-i18n="payment.transactionID">{transaction_id}</p>
              <p id="display-id" class="text-gray-800 font-mono text-sm break-all">N/A</p>
            </div>
            <div>
              <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1" data-i18n="payment.date">{date}</p>
              <p id="display-date" class="text-gray-800 font-medium">--</p>
            </div>
            <div>
              <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1" data-i18n="payment.paymentMethod">{payment_method}</p>
              <div class="flex items-center space-x-2">
                <span class="w-3 h-3 bg-blue-500 rounded-full"></span>
                <p class="text-gray-800 font-medium">PayPal (Simulated)</p>
              </div>
            </div>
            <div>
              <p class="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1" data-i18n="payment.status">{status}</p>
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                Success
              </span>
            </div>
          </div>

          <!-- Note -->
          <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
            <p class="text-blue-700 text-sm italic text-center">
              "This is a simulated transaction for testing purposes. In a production environment, a real payment would have been processed."
            </p>
          </div>

          <!-- Actions -->
          <div class="pt-4 flex flex-col sm:flex-row gap-4 no-print">
            <button 
              onclick="window.print()" 
              class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3 px-6 rounded-xl transition flex items-center justify-center space-x-2"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 00-2 2h2m2 4h10a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
              </svg>
              <span data-i18n="payment.btnPrint">{btnPrint}</span>
            </button>
            <a 
              href="/" data-i18n="payment.btnBack"
              class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-xl transition text-center"
            >
              {btnBack}
            </a>
          </div>
        </div>

        <!-- Ticket Footer (Jagged Edge effect) -->
        <div class="h-4 bg-gray-200 w-full" style="clip-path: polygon(0% 0%, 5% 100%, 10% 0%, 15% 100%, 20% 0%, 25% 100%, 30% 0%, 35% 100%, 40% 0%, 45% 100%, 50% 0%, 55% 100%, 60% 0%, 65% 100%, 70% 0%, 75% 100%, 80% 0%, 85% 100%, 90% 0%, 95% 100%, 100% 0%);"></div>
      </div>
      
      <p class="text-center text-white/40 text-xs mt-8 no-print uppercase tracking-widest font-bold">
        Static Simulation Mode • New Horizons
      </p>
    </div>
  </section>
</MainLayout>

<script>
  // Manejo de datos en el cliente para mantener el sitio estático
  window.addEventListener('DOMContentLoaded', () => {
    const params = new URLSearchParams(window.location.search);
    
    // Elementos del DOM
    const elId = document.getElementById('display-id');
    const elAmount = document.getElementById('display-amount');
    const elDate = document.getElementById('display-date');
    const elClient = document.getElementById('display-client');
    const elService = document.getElementById('display-service');
    const ticket = document.getElementById('ticket');

    // Poblar datos
    if (elId) elId.textContent = params.get('id') || 'SIM-TX-' + Math.random().toString(36).substr(2, 9).toUpperCase();
    if (elAmount) elAmount.textContent = params.get('amount') || '0.00';
    if (elClient) elClient.textContent = params.get('client') || 'Valued Customer';
    if (elService) elService.textContent = params.get('service') || 'Immigration Program';
    
    const rawDate = params.get('date');
    const dateObj = rawDate ? new Date(rawDate) : new Date();
    if (elDate) elDate.textContent = dateObj.toLocaleString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });

    // Animación de entrada
    setTimeout(() => {
      if (ticket) {
        ticket.classList.remove('opacity-0', 'translate-y-4');
        ticket.classList.add('opacity-100', 'translate-y-0');
      }
    }, 100);
  });
</script>

<style>
  @media print {
    .no-print {
      display: none !important;
    }
    body {
      background: white !important;
    }
    section {
      padding: 0 !important;
      background: none !important;
    }
    #ticket {
      box-shadow: none !important;
      border: 1px solid #e5e7eb;
      opacity: 1 !important;
      transform: none !important;
    }
  }
</style>

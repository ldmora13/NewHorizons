---
import { Icon } from "astro-icon/components";

/* =========================
   Types
========================= */
export interface ReviewCardProps {
  name: string;
  country: string;
  avatar: string;
  rating: number; // 1 â€“ 5 (support .5)
  message: string;
  tag?: string;
}

const { name, country, avatar, rating, message, tag } =
  Astro.props as ReviewCardProps;

const fullStars = Math.floor(rating);
const hasHalf = rating % 1 !== 0;
const emptyStars = 5 - fullStars - (hasHalf ? 1 : 0);
---

<div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur p-6">
  <div class="flex items-center gap-4">
    <img
      src={avatar}
      alt={name}
      class="w-12 h-12 rounded-full object-cover border border-white/20"
      loading="lazy"
    />
    <div>
      <div class="font-semibold text-white">{name}</div>
      <div class="text-sm text-white/60">{country}</div>
    </div>
  </div>

  <div class="mt-4">
    {tag && (
      <span class="inline-block text-xs font-medium px-2 py-0.5 rounded-full bg-blue-500/15 text-blue-300 border border-blue-500/20 mb-2">
        {tag}
      </span>
    )}
    <div class="flex items-center gap-1 text-yellow-500">
      {Array.from({ length: fullStars }).map(() => (
        <Icon name="bi:star-fill" class="w-4 h-4" />
      ))}
      {hasHalf && <Icon name="bi:star-half" class="w-4 h-4" />}
      {Array.from({ length: emptyStars }).map(() => (
        <Icon name="bi:star" class="w-4 h-4 opacity-40" />
      ))}
    </div>
  </div>

  <p class="mt-3 text-white/70 leading-relaxed">
    {message}
  </p>
</div>